<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=9">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<link rel="shortcut icon" type="image/png" href="images/favicon-32x32.png" sizes="32x32">
		<link rel="shortcut icon" type="image/png"  href="images/favicon-64x64.png" sizes="64x64">
		<link rel="shortcut icon" type="image/png"  href="images/favicon-128x128.png" sizes="128x128">
		<link rel="shortcut icon" type="image/png"  href="images/favicon-192x192.png" sizes="192x192">
		<link rel="apple-touch-icon" href="filename='images/apple-touch-icon-180x180.png">
		<meta name="msapplication-TileImage" content="images/favicon-270x270.png">

		<link rel="search" href="opensearch.xml"  type="application/opensearchdescription+xml" title="Cover">

		<title>{% block title %}Cover{% endblock %}</title>
		

		{% for stylesheet in view.stylesheets %}
		<link rel="stylesheet" href="{{ stylesheet }}" type="text/css">
		{% endfor %}
		
	    <script defer src="https://use.fontawesome.com/releases/v5.10.2/js/all.js"></script>
	</head>
	<body class="has-navbar-fixed-top">
		{% block menu %}
			{{ include('@layout/widgets/menu.twig') }}
		{% endblock %}

		{% if view.layout.promotional_header %}
		{{ include('@layout/widgets/' ~ view.layout.promotional_header) }}
		{% endif %}
		
		{% if global.auth.logged_in() and global.identity.get('type', -1) == constant('MEMBER_STATUS_UNCONFIRMED') %}
			<section class="section">
				<div class="container is-content-optimized">
					<div class="notification">{{ __('Your application hasn\'t been accepted yet by our [secretary. Until then some parts of the website are not yet accessible, such as all ]the photo albums and contact information of members.') }}</div>
				</div>
			</section>
		{% endif %}
	
		
		{% block page %}
			<section class="section">
				<div class="container is-content-optimized">
					{% block content %}{% endblock %}
				</div>
			</section>
		{% endblock %}

		<footer>
			{{ include('@layout/widgets/partners.twig') }}
			<div class="footer footer-main">
				<ul>
				{% spaceless %}
					<li>
						<a href="show.php?id=17">{{ __('Contact') }}</a>
					</li>
					<li class="divider" role="separator"></li>
					<li>
						<a href="//sd.svcover.nl/Privacy%20Statement/Privacy%20statement.pdf">{{ __('Privacy statement') }}</a>
					</li>
					<li class="divider" role="separator"></li>
					<li>
						<a href="https://bitbucket.org/cover-webcie/cover-php/issues">{{ __('Report a bug')}}</a>
					</li>
				{% endspaceless %}
				</ul>
				{# <div class="content has-text-centered is-centered">
					
					&mdash; 
					&mdash; 
				</div> #}
			</div>
		</footer>

		{# Warn accidental visitors that this is a test version #}
		<div class="modal is-active" id="development-warning-modal">
			<div class="modal-background"></div>
			<div class="modal-content">
				<div class="notification is-danger">
					<h1 class="title is-1">Proceed with caution!</h1>
					<div class="content">
						<p>
							As the URL suggests this is a developmental version of our website, which means that some things may not work as expected.
						</p>
						<p>If you'd report  issues in the <a href="https://bitbucket.org/cover-webcie/cover-php/issues">usual way</a>, but please select <em>Redesign</em> as the version instead of <em>Master</em>.
						</p>
					</div>
					<div class="buttons">
						<a href="https://www.svcover.nl" class="button is-danger is-inverted is-large">I want a working website</a>
						<button type="button" class="button is-danger is-inverted is-large is-outlined" id="continue-button">Continue testing</button>
				</div>
			</div>
		</div>

		{% for script in view.scripts %}
			<script src="{{ script }}"></script>
		{% endfor %}

		{# Some scripts for the development modal. Keep it all contained as much as possible to not interfere with other scripts #}
		<script>
			function DevelopmentModal() {
				function closeModal(evt) {
					var modal = document.getElementById('development-warning-modal');
					document.cookie = 'istester=true';
					modal.remove();	
				}

				function getCookie(name) {
					var cookie = document.cookie
						.split(';')
						.map( cookie => cookie.trim().split("=", 2) )
						.find( cookie => cookie[0] == name );

					if (!cookie) return null;

					return decodeURIComponent(cookie[1])
				}

				var modal = document.getElementById('development-warning-modal');
			
				if (getCookie('istester') == 'true') {
					modal.remove()
				} else {
					modal.querySelector('#continue-button').addEventListener('click', closeModal);
				}
			}

			DevelopmentModal();
		</script>

		{% if view.layout.has_alert %}
			<script>alert({{ view.layout.pop_alert|json_encode|raw }})</script>
		{% endif %}

		{% if global.db.history|length > 0 %}
			<script>
				console.info('Total number of queries run: %d (%0.1fms)', {{ global.db.history|length }}, {{ global.db.history|select('duration')|sum * 1000 }});
				console.groupCollapsed("Queries");
				{% for query in global.db.history %}
				console.info("Duration: %0.3fms: %s", {{query.duration * 1000}}, {{query.query|json_encode()|raw}}, {{ query.backtrace|json_encode()|raw }});
				{% endfor %}
				console.groupEnd();
			</script>
		{% endif %}
	</body>
</html>