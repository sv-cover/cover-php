{% extends 'tab.twig' %}

{% set active_tab = 'mailing_lists' %}

{% block tab_content %}
<article>
	<h2 class="title is-4">{{ __('Mailing lists') }}</h2>
	{% for mailing_list in mailing_lists %}
		<div class="media">
			<div class="media-content">
				<h3 class="title is-5 is-marginless">
					{{ mailing_list.naam }}
					<small class="has-text-weight-normal">({{ mailing_list.adres }})</small>
				</h3>
				<div class="content">
					<p>{{ mailing_list.omschrijving|parse_markup }}</p>
				</div>
			</div>
			<div class="media-right">
				{% if global.policies.Mailinglist.user_can_subscribe(mailing_list) or global.policies.Mailinglist.user_can_unsubscribe(mailing_list) %}
				<form id="mailinglijst-{{ mailing_list.id|e('url') }}-toggle" class="list-group-item-action toggle-action-button {{ mailing_list.subscribed ? 'toggle-state-active' : '' }}" method="post" action="profiel.php?lid={{ iter.id }}&amp;view=mailing_lists">
					{{ html_nonce('mailing_list', iter) }}
					{{ html_input_hidden('mailing_list_id', mailing_list.id) }}
					{% if mailing_list.subscribed %}
						<input type="hidden" name="action" value="unsubscribe">
						<button type="submit" class="button" title="{{ __('You are subscribed to this list. Click to unsubscribe.')|e('html_attr') }}">{{ __('Unsubscribe') }}</button>
					{% else %}
						<input type="hidden" name="action" value="subscribe">
						<button type="submit" class="button" title="{{ __('Click to subscribe.')|e('html_attr') }}">{{ __('Subscribe') }}</button>
					{% endif %}
				</form>
				{% else %}
				<div class="list-group-item-action toggle-action-button toggle-state-disabled {{ mailing_list.subscribed ? 'toggle-state-active' : '' }}">
					<button disabled="disabled" class="button" title="{{ __('You are subscribed to this list. You can ask the committee to unsubscribe you.')|e('html_attr') }}">{{ __('Unsubscribe') }}</button>
				</div>
				{% endif %}
			</div>
		</div>
	{% endfor %}
</article>
{% endblock %}