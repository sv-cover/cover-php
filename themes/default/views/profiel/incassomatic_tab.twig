{% extends 'tab.twig' %}

{% set active_tab = 'incassomatic' %}

{% block tab_content %}
<article>
	<h2 class="title is-4">{{ __('Incass-o-matic') }}</h2>
	<h3 class="subtitle is-5">{{ __('Contract') }}</h3>
	<p>{{ __('Signed and active since %s.')|format(contract.start_datum|date('j-n-Y')) }}</p>
</article>

<article>
	<p>{{ __("Your fifteen most recent direct debits.") }}</p>
	<table class="table is-fullwidth">
	{% if debits_per_batch[""] is defined %}
		<thead>
			<tr>
				<th colspan="3"><h3 class="title is-5">{{ __('To be debited') }}</h3></th>
			</tr>
			<tr>
				<th>{{ __('Description') }}</th>
				<th class="has-text-right">{{ __('Price') }}</th>
				<th class="has-text-right">{{ __('Date') }}</th>
			</tr>
		</thead>
		<tbody>
			{% for debit in debits_per_batch[""] %}
			<tr>
				<td>{{ debit.omschrijving }}</td>
				<td class="has-text-right">
					&euro;&nbsp;{{ '%0.2f'|format(debit.bedrag / 100) }}
				</td>
				<td class="has-text-right">
					<time datetime="{{ debit.aangemaakt|date(constant('DateTime::ISO8601'))|e('html_attr') }}" title="{{ debit.aangemaakt|date('j-n-Y H:i:s')|e('html_attr') }}">{{ debit.aangemaakt|date_relative }}</time>
				</td>
			</tr>
			{% endfor %}
		</tbody>
	{% endif %}
	{% for batch_id, debits in debits_per_batch if batch_id != "" %}
		<thead>
			<tr>
				<th colspan="3">
					<h3 class="title is-5">{{ __('Debit batch %d')|format(batch_id) }}</h3> <small>{{ debits[0].batch.verwerkingsdatum|date('j-n-Y') }}</small>
				</th>
			</tr>
			<tr>
				<th>{{ __('Description') }}</th>
				<th class="has-text-right">{{ __('Price') }}</th>
				<th class="has-text-right">{{ __('Date') }}</th>
			</tr>
		</thead>
		<tbody>
			{% for debit in debits %}
			<tr>
				<td>{{ debit.omschrijving }}</td>
				<td class="has-text-right">
					&euro;&nbsp;{{ '%0.2f'|format(debit.bedrag / 100) }}
				</td>
				<td class="has-text-right">
					<time datetime="{{ debit.aangemaakt|date(constant('DateTime::ISO8601'))|e('html_attr') }}" title="{{ debit.aangemaakt|date('j-n-Y H:i:s')|e('html_attr') }}">{{ debit.aangemaakt|date_relative }}</time>
				</td>
			</tr>
			{% endfor %}
		</tbody>
	{% endfor %}
	</table>
</article>
{% endblock %}
