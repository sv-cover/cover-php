{% extends 'tab.twig' %}

{% set active_tab = 'kast' %}

{% block tab_content %}
<article>
	<h2>{{ __('Consumptions in K.A.S.T.') }}</h2>
	<h4>{{ __('Balance') }}</h4>
	<em>{{ __N('%d credit', '%d credits', status.credits) }}</em>
	<h4>{{ __('Account status') }}</h4>
	<em>{{ status.active ? __('Active') : __('Disabled') }}</em>
</article>

<article>
	<p>{{ __('Your twenty most recent purchases') }}</p>
	<table class="full-width-table">
		<thead>
			<tr>
				<th>{{ __('Product') }}</th>
				<th class="numeric">{{ __('Price') }}</th>
				<th class="timestamp">{{ __('Date') }}</th>
			</tr>
		</thead>
		<tbody>
			{% for purchase in history %}
				{% if purchase.class_name == 'Purchase' %}
					<tr class="{{ purchase.admin ? 'purchase-admin' : '' }} {{ not purchase.valid ? 'purchase-reverted' : '' }}"
						title="{{ purchase.admin ? __('Admin Purchase') : '' }} {{ not purchase.valid ? __('Undone') : '' }}">
						<td>{{ purchase.product_name }}</td>
						<td class="numeric">€ -{{ (purchase.amount_euros/100) |number_format(2) }}</td>
						<td class="timestamp">{{ purchase.timestamp|date_relative }}</td>
					</tr>
				{% elseif purchase.class_name == 'TopUp' %}
					<tr class="{{ purchase.admin ? 'purchase-admin' : '' }} {{ not purchase.valid ? 'purchase-reverted' : '' }}"
						title="{{ purchase.admin ? __('Admin Top Up') : '' }} {{ not purchase.valid ? __('Undone') : '' }}">
						<td>{{ purchase.purchase_category_name }}</td>
						<td class="numeric">€ {{ (purchase.amount_euros/100) |number_format(2) }}</td>
						<td class="timestamp">{{ purchase.timestamp|date_relative }}</td>
					</tr>
				{% endif %}
			{% endfor %}
		</tbody>
	</table>
</article>
{% endblock %}