{% extends '@layout/layout.twig' %}

{% block title __('Membership application form') ~ ' :: ' ~ parent() %}

{% block content %}
<h1>{{ __('Membership application form') }}</h1>
<div class="messageBox">
	<h2>{{ __('Become a member!') }}</h2>

	{% if errors|length > 0 %}
	<section class="error-section">
		<p>{{ __("You haven't filled in all the fields correctly.") }}</p>
	</section>
	{% endif %}

	<form method="post" action="lidworden.php" class="new-member-form vertical-form">
		{{ html_nonce('sign_up') }}
		
		<fieldset>
			<legend>{{ __('Name') }}</legend>
			<div class="field-group">
				<div class="large-field">
					{{ html_label(__('First name'), 'first_name', errors=errors, required=true) }}
					{{ html_input_text('first_name', null, errors=errors, required=true, placeholder=__('E.g. John')) }}
				</div>
				<div>
					{{ html_label(__('Infix'), 'family_name_preposition', errors=errors) }}
					{{ html_input_text('family_name_preposition', null, errors=errors, class='small', placeholder=__('E.g. von')) }}
				</div>
				<div class="large-field">
					{{ html_label(__('Last name'), 'family_name', errors=errors, required=true) }}
					{{ html_input_text('family_name', null, errors=errors, required=true, placeholder=__('E.g. Neumann')) }}
				</div>
			</div>

			<div>
				{{ html_label(__('Birthdate'), 'birth_date', errors=errors, required=true) }}
				{{ html_input_date('birth_date', null, errors=errors, required=true, placeholder=__('E.g. 1993-9-20')) }}
			</div>

			<div>
				{{ html_label(__('Gender'), 'gender', errors=errors, required=true) }}
				{{ html_select_field('gender', {o: __('Unspecified'), m: __('Male'), f: __('Female')}, null, errors=errors, required=true, default='o') }}
			</div>
		</fieldset>

		<fieldset>
			<legend>{{ __('Address') }}</legend>

			<div>
				{{ html_label(__('Street name + number'), 'street_name', errors=errors, required=true) }}
				{{ html_input_text('street_name', null, errors=errors, required=true, placeholder=__('E.g. Nijenborgh 9')) }}
			</div>
			<div class="field-group">
				<div>
					{{ html_label(__('Zipcode'), 'postal_code', errors=errors, required=true) }}
					{{ html_input_text('postal_code', null, errors=errors, required=true, placeholder=__('E.g. 9747 AG')) }}
				</div>
				<div class="large-field">
					{{ html_label(__('Place of residence'), 'place', errors=errors, required=true) }}
					{{ html_input_text('place', null, errors=errors, required=true, placeholder=__('E.g. Groningen')) }}
				</div>
			</div>
		</fieldset>

		<fieldset>
			<legend>{{ __('Contact') }}</legend>

			<div>
				{{ html_label(__('Phone number'), 'phone_number', errors=errors, required=true) }}
				{{ html_input_text('phone_number', null, errors=errors, required=true, type='tel') }}
			</div>

			<div>
				{{ html_label(__('E-mail address'), 'email_address', errors=errors, required=true) }}
				{{ html_input_text('email_address', null, errors=errors, required=true, type='email') }}
				<small>{{ __('You will receive a confirmation email with a link. Your application will be processed after you have clicked the link.') }}</small>
			</div>
		</fieldset>

		<fieldset>
			<legend>{{ __('Study') }}</legend>
			
			<div>
				{{ html_label(__('Student number'), 'membership_student_number', errors=errors, required=true) }}
				{{ html_input_text('membership_student_number', null, errors=errors, required=true, placeholder=__('E.g. s123456')) }}
			</div>

			<div class="field-group">
				<div>
					{{ html_label(__('Study'), 'membership_study_name', errors=errors, required=true) }}
					{{ html_input_text('membership_study_name', null, errors=errors, required=true, list='studies', data_suggestions=['Artificial Intelligence', 'Computing Science']|json_encode, placeholder=__("Pick one from the list or type if your study isn't on it")) }}
					
				</div>

				<div>
					{{ html_label(__('Phase'), 'membership_study_phase', errors=errors, required=true) }}
					{{ html_select_field('membership_study_phase', {b: __('Bachelor'), m: __('Master')}, null, errors=errors, required=true) }}
				</div>
			</div>

			<div>
				{{ html_label(__('Starting year'), 'membership_year_of_enrollment', errors=errors, required=true) }}
				{{ html_input_text('membership_year_of_enrollment', {'membership_year_of_enrollment': academic_year}, errors=errors, required=true) }}
				<small>{{ __('In which year did you start or are you expecting to start with your study.') }}</small>
			</div>
		</fieldset>

		<fieldset>
			<legend>{{ __('Payment') }}</legend>
			
			<div>
				{{ html_label(__('IBAN'), 'iban', errors=errors, required=true) }}
				{{ html_input_text('iban', null, errors=errors, required=true) }}
			</div>

			<div>
				{{ html_label(__('BIC'), 'bic', errors=errors) }}
				{{ html_input_text('bic', null, errors=errors) }}
				<small class="hint">{{ __("Only required if your IBAN [i]does not[/i] start with 'NL'")|parse_markup }}</small>
			</div>

			<div>
				{{ html_input_checkbox('authorization', null) }}
				{{ html_label(__('I hereby authorize Cover to automatically deduct the membership fee from my bank account one time per year. (mandatory)'), 'authorization', errors=errors, required=true) }}
			</div>
		</fieldset>

		<fieldset>
			<legend>{{ __('Mailing list') }}</legend>
			
			<p>{{ __("From time to time Cover sends an email about an upcoming activity. If you don't want to receive these emails anymore, you can very easily unsubscribe right here on the website.")}}

			<div>
				{{ html_input_checkbox('option_mailing', {'option_mailing': 'yes'}) }}
				{{ html_label(__('I want to receive emails about activities organized by Cover.'), 'option_mailing', errors=errors) }}
				<small>{{ __('You can unsubscribe at any moment through this website.') }}</small>
			</div>
		</fieldset>

		<fieldset>
			<legend>{{ __('Conditions') }}</legend>
			{% if user_can_update voorwaarden %}
				<div class="controls inline">
					<a href="{{ link('editable.update', editable=voorwaarden)|e('html_attr') }}" class="edit-link">{{ __('Modify conditions') }}</a>
				</div>
			{% endif %}
		
			{{ voorwaarden.locale_content|parse_markup }}
		</fieldset>

		<fieldset>
			<legend>{{ __('Intelligence test') }}</legend>

			<div>
				{{ html_label(__('What is the colour of grass? (I am not a robot)'), 'spam', errors=errors, required=true) }}
				{{ html_input_text('spam', null, errors=errors, required=true) }}
				<small class="hint">{{ __("If you are unsure, just enter ‘green’.") }}</small>
			</div>
		</fieldset>

		<button type="submit" name="subm" value="yes" class="button large-button">{{ __('Become a member') }}</button>
	</form>



	<section>
		{% if user_can_update opmerkingen %}
			<div class="controls inline">
				<a href="{{ link('editable.update', editable=opmerkingen)|e('html_attr') }}" class="edit-link right">{{ __('Modify notes') }}</a>
			</div>
		{% endif %}
		<h2>{{ __('Notes') }}</h2>
		{{ opmerkingen.locale_content|parse_markup }}
	</section>
</div>
{% endblock %}